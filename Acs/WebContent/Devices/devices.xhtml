<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/recursos/template/template.xhtml">

	<ui:define name="tituloPagina">
		 Devices
	</ui:define>
	<ui:define name="tituloPrincipal">
		<i class="fa fa-cogs"> </i> Devices</ui:define>
	<ui:define name="tituloSecundario"></ui:define>

	<ui:define name="botoesAcao"></ui:define>

	<ui:insert name="eventos">

		<f:metadata>

			<f:event listener="#{loginBean.validaPagina('')}"
				type="preRenderView" />

			<f:event listener="#{loginBean.validarLogin()}" type="preRenderView" />

		</f:metadata>

	</ui:insert>

	<ui:define name="conteudo">

		<h:form id="form">

			<p:panel header="Consulta de Devices">

				<h:panelGrid columns="3">

					<h:outputText value="Parametro" />
					<p:inputText value="#{listDevices.parameter}" />

					<p:commandButton action="#{listDevices.listDevices()}"
						update="dataGridResults" value="Buscar">

						<p:ajaxStatus onstart="PF('loadingDialogInfo').show();"
							onsuccess="PF('loadingDialogInfo').hide();" />

					</p:commandButton>

				</h:panelGrid>

				<br />

				<p:dataGrid value="#{listDevices.listaResults}" var="results"
					columns="3" layout="grid" id="dataGridResults"
					emptyMessage="Nenhum registro encontrado">

					<p:panel header="#{results.vendor} #{results.model}">

						<h:outputText value="Numero de Serie: " />
						<h:outputText value="#{results.serialNumber}" />
						<br />

						<h:outputText value="Mac: " />
						<h:outputText value="#{results.mac}" />
						<br />

						<h:outputText value="Designador: " />
						<h:outputText value="#{results.userKey3}" />
						<br />

						<h:outputText value="Firmware: " />
						<h:outputText value="#{results.softwareVersion}" />
						<br />

						<h:outputText value="Ip: " />
						<h:outputText value="#{results.ip}" />
						<br />

						<h:outputText value="Primeiro contato: " />
						<h:outputText value="#{results.firstContactTimeFormat}" />
						<br />

						<h:outputText value="Class: " />
						<h:outputText value="Modem"
							rendered="#{results.classification=='IAD'}" />
						<h:outputText value="Decoder"
							rendered="#{results.classification=='STB'}" />

						<br />
						<br />

						<p:commandButton value="Abrir"
							update="@form:infoEqpShow formTemplate:msgs"
							oncomplete="PF('infoEqp').show();"
							action="#{deviceInfo.acao(results.id, results.classification)}"
							actionListener="#{devicesActions.clearVariables()}" />
					</p:panel>

				</p:dataGrid>


				<p:dialog header="Informações de Equipamento" widgetVar="infoEqp"
					modal="true" height="500" width="800" minWidth="800"
					minHeight="500" resizable="false">

					<h:panelGroup id="infoEqpShow">

						<p:commandButton value="Reboot"
							onclick="PF('resetDevice').show();"
							rendered="#{deviceInfo.reboot}" />

						<p:commandButton value="Reset de Fabrica"
							onclick="PF('factoryResetDevice').show();"
							rendered="#{deviceInfo.factoryReset}" />

						<p:commandButton value="Equipamentos"
							action="#{devicesActions.getLanHostsTable(deviceInfo.id)}"
							update="lanHosts" rendered="#{deviceInfo.lanHost}" />

						<p:commandButton value="Interface Statistics"
							rendered="#{deviceInfo.interfaceStatistics}"
							onclick="PF('interfaceStatistic').show();" />

						<p:commandButton value="DSL Connection Info"
							rendered="#{deviceInfo.infoDslConnection}"
							onclick="PF('infoDslConnect').show()" />

						<p:commandButton value="Wifi Info"
							action="#{devicesActions.getWiFiInfo(deviceInfo.id)}"
							rendered="#{deviceInfo.wifiInfo}" update="infoWifis"
							oncomplete="PF('infoWifi').show();" />

						<p:commandButton value="FXS" rendered="#{deviceInfo.fxs}"
							oncomplete="PF('sipAccountPro').show();" />

						<p:commandButton value="Consulta Sip"
							rendered="#{deviceInfo.sipDiagnostic}"
							oncomplete="PF('sipDiagnostic').show()" />

						<br />
						<br />

						<p:dataList value="#{deviceInfo.values}" var="valuesInfo"
							type="definition" emptyMessage="Nenhum registro encontrado">

							<h:panelGrid columns="2" style="width: 100%; text-align: center;">

								<h:outputText value="Serial Number: " style="font-weight: bold;" />
								<h:outputText value="#{valuesInfo.sn}" />

								<h:outputText value="Modelo: " style="font-weight: bold;" />
								<h:outputText value="#{valuesInfo.model}" />

								<h:outputText value="Versão do Firmware: "
									style="font-weight: bold;" />
								<h:outputText value="#{valuesInfo.firmver}" />

								<h:outputText value="Ip Address WAN: "
									style="font-weight: bold;" />
								<h:outputText value="#{valuesInfo.wanIpAddress}" />

								<h:outputText value="Device Type: " style="font-weight: bold;" />
								<h:outputText value="#{valuesInfo.devicetype}" />

								<h:outputText value="Uptime" style="font-weight: bold;" />
								<h:outputText value="#{valuesInfo.uptime}" />

							</h:panelGrid>

						</p:dataList>

						<br />

						<h:panelGroup id="lanHosts">

							<p:dataGrid value="#{devicesActions.lanHostHolders}"
								var="lanHost" columns="2" layout="grid"
								emptyMessage="Nenhum registro encontrado"
								rendered="#{deviceInfo.type.equalsIgnoreCase('IAD') and not empty devicesActions.lanHostHolders}">

								<p:panel header="#{lanHost.hostinst}">

									<h:outputText value="Host Name: " style="font-weight: bold;" />
									<h:outputText value="#{lanHost.hostname}" />
									<br />

									<h:outputText value="Status: " style="font-weight: bold;" />
									<h:outputText value="Ativo" rendered="#{lanHost.status}" />
									<h:outputText value="Inativo" rendered="#{!lanHost.status}" />
									<br />

									<h:outputText value="Tipo conexão: " style="font-weight: bold;" />
									<h:outputText value="#{lanHost.iftype}" />
									<br />

									<h:outputText value="Mac: " style="font-weight: bold;" />
									<h:outputText value="#{lanHost.hostmac}" />
									<br />

									<h:outputText value="Tempo de Conexão: "
										style="font-weight: bold;" />
									<h:outputText value="#{lanHost.ltremain}" />
									<br />

								</p:panel>

							</p:dataGrid>

						</h:panelGroup>

						<p:dialog header="Informações do Wifi" widgetVar="infoWifi"
							id="infoWifis" resizable="false" minHeight="200" minWidth="300"
							height="200" width="300">

							<h:panelGrid columns="2" style="width: 100%; text-align: center;"
								id="infoWifiGets">

								<h:outputText value="EnableStatus" />
								<h:outputText
									value="#{devicesActions.wifiInfoHolder.enableStatus}" />

								<h:outputText value="Channel" />
								<h:outputText value="#{devicesActions.wifiInfoHolder.channel}" />

								<h:outputText value="Encryption" />
								<h:outputText
									value="#{devicesActions.wifiInfoHolder.encryption}" />

								<h:outputText value="SSID" />
								<h:outputText value="#{devicesActions.wifiInfoHolder.SSID}" />

								<h:outputText value="macAddresses" />
								<h:outputText
									value="#{devicesActions.wifiInfoHolder.macAddresses}" />

								<h:outputText value="Authentication" />
								<h:outputText
									value="#{devicesActions.wifiInfoHolder.authentication}" />

								<h:outputText value="bytesSent" />
								<h:outputText value="#{devicesActions.wifiInfoHolder.bytesSent}" />

								<h:outputText value="bytesReceived" />
								<h:outputText
									value="#{devicesActions.wifiInfoHolder.bytesReceived}" />

							</h:panelGrid>

						</p:dialog>

						<p:dialog header="Interface Statistics"
							widgetVar="interfaceStatistic" resizable="false" width="600"
							minWidth="600" height="400" minHeight="400">

							<p:commandButton value="Buscar"
								widgetVar="buscarInterfaceStatics"
								actionListener="#{devicesActions.interfaceStatics(deviceInfo.id)}"
								update="interfaceStatistics formTemplate:msgs"
								onclick="PF('buscarInterfaceStatics').disable()"
								oncomplete="PF('buscarInterfaceStatics').enable()" />

							<p:dataGrid id="interfaceStatistics"
								value="#{devicesActions.interfaceStaticsHolder.values}"
								var="interfaceStatistics" columns="3" layout="grid"
								emptyMessage="Nenhum registro encontrado">

								<p:panel header="#{interfaceStatistics.name}">

									<h:outputText value="Type:" />
									<h:outputText value="#{interfaceStatistics.type}" />
									<br />

									<h:outputText value="Status:" />
									<h:outputText value="#{interfaceStatistics.status}" />
									<br />

									<h:outputText value="Enabled:" />
									<h:outputText value="#{interfaceStatistics.enabled}" />
									<br />

									<h:outputText value="Name:" />
									<h:outputText value="#{interfaceStatistics.name}" />
									<br />

									<h:outputText value="Ip:" />
									<h:outputText value="#{interfaceStatistics.ip}" />
									<br />

									<h:outputText value="Mac:" />
									<h:outputText value="#{interfaceStatistics.mac}" />
									<br />

									<h:outputText value="Bytes Send:" />
									<h:outputText value="#{interfaceStatistics.bytesSent}" />
									<br />

									<h:outputText value="Bytes Received:" />
									<h:outputText value="#{interfaceStatistics.bytesReceived}" />
									<br />

									<h:outputText value="Errors Send:" />
									<h:outputText value="#{interfaceStatistics.errorsSent}" />
									<br />

									<h:outputText value="Errors Received:" />
									<h:outputText value="#{interfaceStatistics.errorsReceived}" />
									<br />

									<h:outputText value="Packet Send:" />
									<h:outputText value="#{interfaceStatistics.packetsSent}" />
									<br />

									<h:outputText value="Packet Received:" />
									<h:outputText value="#{interfaceStatistics.packetsReceived}" />
									<br />

								</p:panel>

							</p:dataGrid>

						</p:dialog>

						<p:dialog header="Informação DSL Connection"
							widgetVar="infoDslConnect" resizable="false" width="600"
							minWidth="600" height="220" minHeight="220">
							
							<p:commandButton value="Buscar"
								widgetVar="buscarDslConnect"
								actionListener="#{devicesActions.getDSLConnectionInfo(deviceInfo.id)}"
								update="dslConnectInfos formTemplate:msgs"
								onclick="PF('buscarDslConnect').disable()"
								oncomplete="PF('buscarDslConnect').enable()" />

							<p:dataGrid id="dslConnectInfos"
								value="#{devicesActions.valuesDslConnection}"
								var="dslConnectInfo" columns="2" layout="grid"
								emptyMessage="Nenhum registro encontrado">

								<p:panel header="#{dslConnectInfo.direction}">

									<h:outputText value="Modulação: " />
									<h:outputText value="#{dslConnectInfo.modulationType}" />
									<br />

									<h:outputText value="Error Seconds: " />
									<h:outputText value="#{dslConnectInfo.errorSeconds}" />
									<br />

									<h:outputText value="FEC Errors: " />
									<h:outputText value="#{dslConnectInfo.FECErrors}" />
									<br />

									<h:outputText value="CRC Errors: " />
									<h:outputText value="#{dslConnectInfo.CRCErrors}" />
									<br />

									<h:outputText value="HEC Errors: " />
									<h:outputText value="#{dslConnectInfo.HECErrors}" />
									<br />

									<h:outputText value="Loss of Framing: " />
									<h:outputText value="#{dslConnectInfo.lossOfFraming}" />
									<br />

									<h:outputText value="Loss of Link: " />
									<h:outputText value="#{dslConnectInfo.lossOfLink}" />
									<br />

									<h:outputText value="Noise Margin: " />
									<h:outputText value="#{dslConnectInfo.noiseMargin}" />
									<br />

									<h:outputText value="Max Rate: " />
									<h:outputText value="#{dslConnectInfo.maxRate}" />
									<br />

									<h:outputText value="DSL Show Time Start: " />
									<h:outputText value="#{dslConnectInfo.dslShowtimeStart}" />
									<br />

									<h:outputText value="Attenuation : " />
									<h:outputText value="#{dslConnectInfo.attenuation}" />
									<br />

									<h:outputText value="Power Level: " />
									<h:outputText value="#{dslConnectInfo.powerLevel}" />
									<br />

									<h:outputText value="Synch Rate: " />
									<h:outputText value="#{dslConnectInfo.synchRate}" />
									<br />

								</p:panel>

							</p:dataGrid>

						</p:dialog>

					</h:panelGroup>

					<p:dialog header="Reset de Modem" widgetVar="resetDevice"
						resizable="false" height="60" width="145" minHeight="60"
						minWidth="145">

						<h:outputText value="Você tem certeza?" />

						<h:panelGrid columns="2">

							<p:commandButton value="Sim" update="formTemplate:msgs"
								action="#{devicesActions.Reboot(deviceInfo.id)}"
								oncomplete="PF('resetDevice').hide();" />
							<p:commandButton value="Não"
								oncomplete="PF('resetDevice').hide();" />

						</h:panelGrid>

					</p:dialog>

					<p:dialog header="Reset de Fabrica" widgetVar="factoryResetDevice"
						resizable="false" height="60" width="145" minHeight="60"
						minWidth="145">

						<h:outputText value="Você tem certeza?" />

						<h:panelGrid columns="2">

							<p:commandButton value="Sim" update="formTemplate:msgs"
								action="#{devicesActions.factoryReset(deviceInfo.id)}"
								oncomplete="PF('factoryResetDevice').hide();" />
							<p:commandButton value="Não"
								oncomplete="PF('factoryResetDevice').hide();" />

						</h:panelGrid>

					</p:dialog>

				</p:dialog>

				<p:dialog header="FXS" widgetVar="sipAccountPro" resizable="false"
					width="300" minWidth="300" height="250" minHeight="250">

					<h:panelGrid columns="2">

						<h:outputText value="DirectoryNumber" />
						<p:inputText
							value="#{devicesActions.sipAccountProvisioning.directoryNumber}"
							placeholder="+55 Instância" />

						<h:outputText value="AuthUserName" />
						<p:inputText
							value="#{devicesActions.sipAccountProvisioning.authUserName}"
							placeholder="Instância" />

						<h:outputText value="AuthPassword" />
						<p:inputText
							value="#{devicesActions.sipAccountProvisioning.authPassword}"
							placeholder="Senha" />

						<h:outputText value="ProxyServer" />
						<p:inputText
							value="#{devicesActions.sipAccountProvisioning.proxyServer}"
							placeholder="Proxy" />

						<h:outputText value="RegistrarServer" />
						<p:inputText
							value="#{devicesActions.sipAccountProvisioning.registrarServer}"
							placeholder="Domain IMS" />

						<h:outputText value="UserAgentDomain" />
						<p:inputText
							value="#{devicesActions.sipAccountProvisioning.userAgentDomain}"
							placeholder="Domain IMS" />

						<h:outputText value="OutboundProxy" />
						<p:inputText
							value="#{devicesActions.sipAccountProvisioning.outboundProxy}"
							placeholder="Proxy" />

						<h:outputText value="PhyReferenceList" />
						<p:inputText
							value="#{devicesActions.sipAccountProvisioning.directoryNumber}"
							placeholder="1" />

					</h:panelGrid>

					<p:commandButton value="Eviar FXS"
						action="#{devicesActions.sipAccountProvisioning(deviceInfo.id)}"
						update="@all formTemplate:msgs" />

				</p:dialog>

				<p:dialog header="Sip Status" widgetVar="sipDiagnostic"
					resizable="false" width="300" minWidth="300" height="400"
					minHeight="400">

					<h:panelGrid columns="2">

						<h:outputText value="PhyReferenceList" />
						<p:inputText value="#{devicesActions.phyReferenceList}" />

						<p:commandButton value="Consultar"
							action="#{devicesActions.sipDiagnostics(deviceInfo.id)}"
							update="sipDiagnosticsValues" />

					</h:panelGrid>

					<br />

					<p:panelGrid columns="2" id="sipDiagnosticsValues"
						style="width: 100%;">

						<h:outputText value="UserAgentDomain" />
						<h:outputText value="#{devicesActions.values.userAgentDomain}" />

						<h:outputText value="DirectoryNumber" />
						<h:outputText value="#{devicesActions.values.directoryNumber}" />

						<h:outputText value="T38Enabled" />
						<h:outputText value="#{devicesActions.values.t38Enabled}" />

						<h:outputText value="DTMFMethod" />
						<h:outputText value="#{devicesActions.values.DTMFMethod}" />

						<h:outputText value="VoiceCodec" />
						<h:outputText value="#{devicesActions.values.voiceCodec}" />

						<h:outputText value="Enable" />
						<h:outputText value="#{devicesActions.values.enable}" />

						<h:outputText value="Status" />
						<h:outputText value="#{devicesActions.values.status}" />

						<h:outputText value="AuthUserName" />
						<h:outputText value="#{devicesActions.values.authUserName}" />

						<h:outputText value="IPAddress" />
						<h:outputText value="#{devicesActions.values.IPAddress}" />

						<h:outputText value="ProxyServer" />
						<h:outputText value="#{devicesActions.values.proxyServer}" />

						<h:outputText value="CallState" />
						<h:outputText value="#{devicesActions.values.callState}" />

						<h:outputText value="LostPackets" />
						<h:outputText value="#{devicesActions.values.lostPackets}" />

						<h:outputText value="OutboundProxy" />
						<h:outputText value="#{devicesActions.values.outboundProxy}" />

						<h:outputText value="ConferenceCallURI" />
						<h:outputText value="#{devicesActions.values.conferenceCallURI}" />

					</p:panelGrid>

				</p:dialog>

				<p:dialog widgetVar="loadingDialogInfo" header="Aguarde..."
					resizable="false" width="260" height="25" minWidth="260"
					minHeight="25" showEffect="fade" hideEffect="fade" modal="true">

					<img id="j_idt17:form:j_idt45"
						src="/Acs/recursos/images/ajax-loader.gif" alt="" />

				</p:dialog>

			</p:panel>

		</h:form>

	</ui:define>
</ui:composition>
</html>